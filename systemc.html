<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>The Sparta Modeling Framework: SystemC Models</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">The Sparta Modeling Framework
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('systemc.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">SystemC Models </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The Sparta Scheduler can work in a SystemC environment using the <a class="el" href="classsparta_1_1SysCSpartaSchedulerAdapter.html" title="Class that &quot;connects&quot; Sparta to SystemC.">sparta::SysCSpartaSchedulerAdapter</a>.</p>
<h1><a class="anchor" id="building_sysc"></a>
Building</h1>
<p>There is no requirement to build Sparta any differently to enable SystemC in Sparta. However, to run the testing (and example), make sure the Sparta CMake build environment can find the SystemC package during configuration. A message in the configuration output will be written if the package was found:</p>
<div class="fragment"><div class="line">% cd <a class="code" href="namespacesparta.html">sparta</a>/build; cmake .. -DCMAKE_BUILD_TYPE=Release</div>
<div class="line">...</div>
<div class="line">-- SystemC enabled: 2.3.3.20181013</div>
<div class="line">...</div>
</div><!-- fragment --><p>If not, then <code>cmake</code> could not find the SystemC package. This can happen if there exists an install of SystemC elsewhere on the system (like a user's home directory). Sparta can still use that install, but it must be built with the same C++ standard. First, build SystemC:</p>
<div class="fragment"><div class="line">cd /path/to/systemc-2.3.3; mkdir build; cd build</div>
<div class="line">cmake .. -DCMAKE_CXX_STANDARD=17 -DCMAKE_BUILD_TYPE=Release</div>
<div class="line">make install</div>
</div><!-- fragment --><p>Then, configure/build Sparta again:</p>
<ol type="1">
<li>Set your <code>SYSTEMC_HOME</code> environment variable to the SystemC build: <code>export SYSTEMC_HOME=/path/to/systemc-2.3.3</code></li>
<li>Re-configure Sparta: <code>cmake .. -DCMAKE_BUILD_TYPE=Release</code></li>
</ol>
<p>The enablement message should print at this point.</p>
<p>To build/run the SystemC example (example/SystemC), the TLM <code>example</code> directory must be found. Since the TLM examples are not part of an install, the Sparta SystemC example CMakeLists.txt file will use the environment variable SYSTEMC_HOME to locate it.</p>
<h1><a class="anchor" id="sysc_adapter"></a>
SystemC/Sparta Adapter</h1>
<p>The <a class="el" href="classsparta_1_1SysCSpartaSchedulerAdapter.html" title="Class that &quot;connects&quot; Sparta to SystemC.">sparta::SysCSpartaSchedulerAdapter</a> is just that, and adapter that syncs the SystemC clock with the Sparta Scheduler. With this class, the modeler is not responsible for advancing time on the Sparta scheduler. SystemC will be doing that via SC_THREADs.</p>
<p>However, Sparta assume "control" of the scheduling in that the adapter by starting the SystemC scheduler (<code>sc_core::sc_start</code>) via the <a class="el" href="classsparta_1_1SysCSpartaSchedulerAdapter.html#a972ac4ded0ecfff5c34aa96a3381a1ce" title="Run simulation â€“ all of it including SystemC.">sparta::SysCSpartaSchedulerAdapter::run</a> method.</p>
<p>The expected development using this adapter is:</p>
<ol type="1">
<li>Implement <code>sc_main</code> as normal</li>
<li>Instantiate Sparta components including a <a class="el" href="classsparta_1_1Scheduler.html" title="A class that lets you schedule events now and in the future.">sparta::Scheduler</a>, <a class="el" href="classsparta_1_1ResourceTreeNode.html" title="TreeNode subclass representing a node in the device tree which contains a single ResourceFactory and ...">sparta::ResourceTreeNode</a>, etc</li>
<li>Instantiate the <a class="el" href="classsparta_1_1SysCSpartaSchedulerAdapter.html" title="Class that &quot;connects&quot; Sparta to SystemC.">sparta::SysCSpartaSchedulerAdapter</a> passing to its constructor the <a class="el" href="classsparta_1_1Scheduler.html" title="A class that lets you schedule events now and in the future.">sparta::Scheduler</a> created</li>
<li>Call <code>run()</code> on the adapter</li>
</ol>
<p>See an example of this in <code>sparta/test/SystemC_test.cpp</code></p>
<p>Caveats:</p>
<ol type="1">
<li>Only one adapter is allowed in simulation</li>
<li>Only one <a class="el" href="classsparta_1_1Scheduler.html" title="A class that lets you schedule events now and in the future.">sparta::Scheduler</a> is allowed in simulation</li>
<li>Time bounces between SystemC advancement and Sparta. Zero-timed communication between a SysC component and a Sparta component will not work. This is due how the adapter operates. Time is given to SystemC, which catches up to Sparta, then Sparta moves ahead (by at most 1 tick). If a SystemC (or Sparta) component requests a send/immediate response to a component in the other modeling environment, there will always be a lag. This is something that can be fixed, but there have been no use cases to date for this need</li>
<li>Communication between a Sparta component (Sparta Port) and a SystemC Port (or TLM callback) requires a Sparta/SystemC gasket to be written by the modeler </li>
</ol>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div class="ttc" id="anamespacesparta_html"><div class="ttname"><a href="namespacesparta.html">sparta</a></div><div class="ttdoc">Macros for handling exponential backoff.</div><div class="ttdef"><b>Definition:</b> <a href="AppTriggers_8hpp_source.html#l00022">AppTriggers.hpp:22</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Fri Sep 25 2020 04:28:26 for The Sparta Modeling Framework by <a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
